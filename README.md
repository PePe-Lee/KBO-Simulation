# KBO-Simulation


# 프로젝트 목표

1. 파이썬 언어를 처음 배우면서 코딩 능력을 기르기.
2. 파이토닉한 코드 작성 방식에 익숙해지고, 데이터 처리 기술 익히기.
3. 야구 데이터를 활용해 흥미와 학습을 결합한 프로젝트 진행.
4. 데이터 분석 및 시뮬레이션 결과를 통해 야구 경기의 성과 예측 경험을 쌓기.
5. 나아가 정량적 데이터 기반 게임 분석 분야로 확장할 기초 마련.



## 프로젝트 개요

KBO 리그의 투수와 타자 데이터를 활용해 팀 간 시뮬레이션을 수행하고, 경기 결과를 예측하는 프로그램입니다. 주 작업은 다음과 같습니다:

1. CSV/Excel 파일에서 선수 데이터를 로드하고 팀별로 그룹화.
2. 타자와 투수의 세이버매트릭스 지표를 기반으로 성과 분석.
3. 9이닝 시뮬레이션을 통해 실제 야구 경기의 결과를 가상으로 재현.
4. 랜덤 날씨 요소와 선수의 선호 날씨 데이터를 활용해 경기 변수 추가

타자와 투수의 평가 지표
- 타자 지표: 타율, 볼넷율, 삼진율, 타석, 타수, 안타, 단타, 2루타, 3루타, 홈런, wRC, 날씨
- 투수 지표: 볼넷/9, 삼진/9, ERA, 날씨


## 주요 기능

 1. 데이터 로드 및 전처리:
- pandas를 사용해 CSV/Excel 데이터를 파싱하고, 투수 및 타자의 성적 지표를 정리.
- 선수의 팀과 포지션에 따라 데이터를 자동 분류.

![image](https://github.com/user-attachments/assets/46bbab73-39b3-48e4-b9f9-c91242585775)


2. 팀 구성:

- 사용자와 AI가 각각 팀을 구성. AI는 성적에 따라 최적화된 선발/불펜 및 타자 명단을 선택.
- 사용자는 팀을 선택하고 선택한 팀 명단에 선호하는 선수들로  출전 명단을 꾸릴 수 있음.

 ![image](https://github.com/user-attachments/assets/9e9f43d8-991a-4d57-8e6d-84e16cc62fa5)

3. 9이닝 경기 시뮬레이션:

- 타자와 투수 간의 대결 결과(볼넷, 삼진, 안타 등)를 확률적으로 계산.
- 날씨와 선호 조건에 따라 선수의 성과를 조정.
- 각 이닝 종료 후 몇 득점 했는지 출력.
 



## 확률 기반 시뮬레이션 구현 

초기값과 선수의 개별 성적 데이터를 바탕으로 각 이벤트의 확률을 설정.

주요 이벤트:
1.  볼넷
-  초기값 11%에서 시작하며, 타자의 볼넷 비율과 투수의 9이닝당 볼넷 허용률로 조정.
- 공식: 타자의 볼넷율 × 0.2 + (11 + 2.5 × (투수 9이닝 볼넷 허용률 - 4.2))%
- 공식 설정 이유: 볼넷은 투수의 제구가 높은 영향력을 가지고 있다 판단하여 투수의 볼넷/9을 기반으로 확률 부여 
- 타자의 선구안도 고려하여 타자의 볼넷% 일부 반영 
- 11% 리그 평균 타자 볼넷%, 4.2는 리그 평균 투수 9이닝당 평균 볼넷 내주는 개수) 
- 투수의 볼넷/9이 낮으면 볼넷확률 감소함 , 타자의 볼넷% 높으면 볼넷확률 소폭 증가 
- 볼넷에 따른 주자 이동 이벤트 구현

2. 삼진
- 초기값 20%에서 시작하며, 타자의 삼진율과 투수의 삼진률에 따라 변동.
- 공식: 타자의 삼진율 × 0.2 + (20 + 2.5 × (투수 9이닝 삼진 개수 - 7.2))%
- 공식 설정 이유: 삼진을 투수의 역량이 높은 영향력을 가지고 있다 판단하여 투수의 볼넷/9을 기반으로 확률 부여
- 타자의 삼진%도 고려하여 타자의 삼진% 일부 반영
- 투수의 삼진/9 낮으면 삼진 확률 감소함, 타자의 삼진% 높으면 삼진 확률 소폭 증가 
3. 몸에 맞는 공
- 고정값 3%.
- 9이닝당 평균 사사구 개수를 평균 타석으로 나눈결과 타석에서 사사구 맞을 확률 리그 평균 3프로 따라서 고정값 3프로 부여 
- 몸에 맞는 공에 따른 주자 이동 이벤트 구현
 
4. 플라이 아웃
- 공식: 0.5 * (100 -  볼넷 확률 - 삼진 확률 - 안타 확률 - 몸에 맞는 공 확률) 
- 공식 설정 이유: 간단하게 볼넷,삼진,안타,몸에 맞는공 확률을 뺀 확률이 아웃임을 착안 
- 곱하기 0.5 한 이유는 땅볼아웃과 플라이 아웃을 구별해 주자 진루하는 이벤트 구현하기 위해서 
- 0아웃,1아웃일때 주자 3루에 있으면 희생플라이 이벤트 구현 
안타 확률 및 안타 유형 계산:

5. 땅볼 아웃
- 공식: 0.5 * (100 -  볼넷 확률 - 삼진 확률 - 안타 확률 - 몸에 맞는 공 확률) 
- 공식 설정 이유: 간단하게 볼넷,삼진,안타,몸에 맞는공 확률을 뺀 확률이 아웃임을 착안
- 곱하기 0.5 한 이유는 땅볼아웃과 플라이 아웃을 구별해 주자 진루하는 이벤트 구현하기 위해서 
- 0아웃,1아웃일때 병살 이벤트, 희생타 이벤트 구현
-  2아웃일때는 주자 아웃 처리 

6. 안타
 - 초기값 27%에서 시작하며, 타자의 타율과 투수의 ERA에 따라 증감.
- 공식: 타자의 타율 + (투수의 ERA - 4.8) × 0.06
- 공식 설정 이유: 안타는 타자의 타율의 기반으로함 
- 안타를 쳤을때 장타일 확률은 타자가 안타쳣을때 단타,2루타,3루타,홈런 지표로 구현  
- ERA는 결국 투수의 안타 허용률과 그 팀의 수비를 반영하는 지표기에 채택  4.8은 평균 리그 투수의 ERA 
- 계산 결과가 음수일 경우, 안타 확률은 0%로 설정.
- 안타 발생 시: 단타, 2루타, 3루타, 홈런은 각각의 확률로 결정.
- 확률 계산식: 단타: 단타 / 총 안타, 2루타: 2루타 / 총 안타, 3루타: 3루타 / 총 안타, 홈런: 홈런 / 총 안타
- 특정 유형의 안타 확률이 0일 경우, 해당 유형을 제외하고 계산.
- 주자 상황별 이벤트 처리 구현

7. 날씨 효과 적용:
- "맑음", "흐림", "비옴", "눈옴" 중 랜덤으로 날씨 설정.
- 각 선수의 선호 날씨에 따라 성적을 가중치로 조정.


##  프로그램 실행 방법

필요한 환경: Python 3.7 이상, pandas 등 필수 라이브러리

![image](https://github.com/user-attachments/assets/1275b43e-597a-4d82-b752-8e66a0ed5e5e)

실행: 프로젝트 폴더에서 KBO.py를 들어가 xslx경로를 본인이 컴퓨터에 맞게 변경 
KBO.py 작동


## 창의적인 요소

1. 랜덤 날씨와 선수 선호 조건:

- "맑음", "흐림", "비옴", "눈옴" 등의 날씨를 랜덤으로 설정.
- 각 선수의 날씨 선호도에 따라 성과를 가중치로 조정.

2. 세부적인 경기 시뮬레이션:

- 타격 결과를 세분화(단타, 2루타, 3루타, 홈런)하여 더 사실적인 경기 재현.
- 희생타, 땅볼 아웃 등 실제 경기 상황을 반영하고 그에 따른 주자 움직임 구현.

3. 팀 자동 구성:

- AI 팀은 각 포지션에서 최적의 선수를 자동 선발.
- 제한된 자원으로도 효율적인 팀 구성 실현.




# 한계점과 개선 방향
한계점과 개선 방향
1. 데이터가 충분하지 않아 구현하지 못한 부분이 있음: 수비 실책 이벤트, 도루, 스트라이크 볼 기반 타석 구현 등등   ex) 포수 도루 저지율, 내야수, 외야수 수비 지표
2. AI팀을 선택하는 기능이 없음 
3. 지금은 시물레이션을 확률로 유저의 전략적 개입이 없이 진행되지만 타석마다 유저의 명령하기 기능을 넣어서 유저의 상호작용을 통해 확률 여러 지표 버프 디버프를 줘서 경기에 영향을 주게 개선하고 싶다. ex) 큰 스윙 금지 -> 안타 확률 증가 but 장타일 확률 하락, 보내기 번트 명령 등등 
## 프로젝트를 통해 배운 점
1.파이썬 프로그래밍:
- 데이터 구조 활용, 함수 작성, 파일 입출력 등 기본 파이썬 기술 습득.
- 데이터 처리에 pandas를 적용하며 대규모 데이터 분석 경험.

2.야구 데이터 분석:

- 타자와 투수의 주요 지표를 정리하고, 이를 바탕으로 성과를 예측.
- 실질적인 경기 상황을 고려해 시뮬레이션 설계.

3. 향후 계획:

- 요새나온 움직임 분석 프로그램을 이용해 투수의 투구폼 분석을 통해 투수가 타자에게 공 던질 때 변화하는 투구폼을 보고 던질 구종을 예측하고 투수의 어떤 부분을 그건로 예측했는지 알려주는 프로그램 개발. -> 이를 통해 투수의 습관ex) 직구를 던질때는 글러브를 오무리고, 변화구를 던질때 글러브를 벌림 등등, 투구폼(직구와 변화구의 팔 높이가 다름)을 분석해 타자가 투수와의 승부에서 유리해지는게 목표
